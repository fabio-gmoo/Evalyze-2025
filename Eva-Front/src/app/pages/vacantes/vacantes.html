<!-- src/app/pages/vacantes/vacantes.html (REFACTORED) -->
<div class="vacantes-container">
  <!-- Header -->
  <app-vacancy-header />

  <!-- Stats (solo empresa) -->
  @if (viewMode() === 'company') {
    <app-stats-grid [stats]="stats()" />
  }

  <!-- Tabs (solo empresa) -->
  @if (viewMode() === 'company') {
    <app-vacancy-tabs [tabs]="tabs" [activeTab]="activeTab()" (tabChange)="setActiveTab($event)" />
  }

  <!-- Secci칩n de acciones -->
  <div class="section-header">
    <div>
      @if (viewMode() === 'company') {
        <h2>Gesti칩n de Vacantes</h2>
        <p>Crea y administra posiciones abiertas con configuraci칩n de IA.</p>
      }
      @if (viewMode() === 'candidate') {
        <h2>Todas las Vacantes</h2>
        <p>Aplica a las oportunidades que m치s te interesen.</p>
      }
    </div>

    @if (viewMode() === 'company') {
      <div>
        <button class="btn-primary" (click)="openModal(null)" type="button">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M12 5v14M5 12h14" stroke="white" stroke-width="2" stroke-linecap="round" />
          </svg>
          Nueva Vacante
        </button>
      </div>
    }
  </div>

  <!-- Lista de vacantes -->
  <app-vacancy-list
    [vacancies]="vacantes()"
    [viewMode]="viewMode()"
    [loading]="loading()"
    (edit)="openModal($event)"
    (delete)="eliminarVacante($event)"
    (apply)="openChat($event)"
    (createNew)="openModal(null)"
  />

  <!-- Modal crear/editar -->
  <app-vacancy-modal
    [show]="showModal()"
    [editingVacante]="editingVacante()"
    [formData]="formData()"
    [preguntas]="preguntas()"
    [loading]="loading()"
    [duracion]="formData().duracion"
    [puntuacionMinima]="formData().puntuacionMinima"
    (close)="closeModal()"
    (save)="guardarVacante()"
    (generateWithAI)="generarConIA()"
    (fieldUpdate)="updateFormField($event)"
    (arrayItemUpdate)="updateArrayItem($event)"
    (arrayItemAdd)="addArrayItem()"
    (arrayItemRemove)="removeArrayItem($event)"
    (preguntaAdd)="addPregunta()"
    (preguntaRemove)="removePregunta($event)"
    (preguntaUpdate)="updatePregunta($event)"
  />

  <!-- Chat drawer (postulante) -->
  <app-chat-drawer
    [open]="chatOpen()"
    [messages]="chatMessages()"
    [vacancy]="chatVacante()"
    [draft]="chatDraft()"
    (close)="closeChat()"
    (send)="sendMessage($event)"
    (draftChange)="updateChatDraft($event)"
  />
</div>
